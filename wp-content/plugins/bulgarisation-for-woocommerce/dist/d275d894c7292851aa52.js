(window.webpackJsonp=window.webpackJsonp||[]).push([[23],{152:function(e,t,o){"use strict";o.r(t);var a=o(153),i=o.n(a);for(var n in a)["default"].indexOf(n)<0&&function(e){o.d(t,e,(function(){return a[e]}))}(n);t.default=i.a},153:function(e,t,o){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});var a=o(93),i=c(o(90)),n=c(o(4)),s=c(o(5)),r=c(o(91));function c(e){return e&&e.__esModule?e:{default:e}}o(114),t.default={components:{Multiselect:r.default},data:function(){return{Address1Field:"",selectedApm:[],apms:[],error:"",document:e(document.body),i18n:wooBg_boxnow.i18n}},computed:{apmLocatorUrl:function(){var e=this;return setTimeout((function(){e.initApmLocator()}),50),"https://widget-v5.boxnow.bg/popup.html?gps=yes&autoselect=yes&autoclose=yes"}},mounted:function(){var t=this;this.loadLocalStorage(),this.checkFields(),e("#ship-to-different-address-checkbox").on("change",(function(){t.checkFields()})),this.loadApms(),this.initApmLocator(),this.document.on("update_checkout.onUpdate",this.onUpdate),window.boxnowApmInitialUpdate&&(this.document.trigger("update_checkout"),window.boxnowApmInitialUpdate=!1,this.setAddress1FieldData())},methods:{setApmFromLocator:function(t){if("https://widget-v5.boxnow.bg"===t.origin){var o=t.data.boxnowLockerId;if(this.apms.length){var a=this;this.apms.forEach((function(e){e.id==o&&(a.selectedApm=e,a.setApm())}))}e.magnificPopup.close()}},initApmLocator:function(){e("#woo-bg--boxnow-apm-locator").magnificPopup({type:"iframe",midClick:!0,iframe:{markup:'<iframe class="mfp-iframe" src="https://widget-v5.boxnow.bg/popup.html?gps=yes&autoselect=yes&autoclose=yes" frameborder="0" allowfullscreen></iframe>'},callbacks:{open:function(){e(".mfp-iframe").css("width","100%"),e(".mfp-iframe").css("height","100%"),e(".mfp-bg.mfp-ready").css("background","none"),e(".mfp-container").css("padding","0"),e(".mfp-content").css("max-width","100%"),e(".mfp-content").css("height","100%")}}}),window.addEventListener("message",this.setApmFromLocator,!1)},compileLabel:function(e){var t=e.name,o=e.addressLine1;return t+" ("+e.addressLine2+" - "+o+")"},checkFields:function(){e("#ship-to-different-address-checkbox").is(":checked")?this.Address1Field=e("#shipping_address_1"):this.Address1Field=e("#billing_address_1")},loadLocalStorage:function(){var e=localStorage.getItem("woo-bg--boxnow-apm");e&&(e=JSON.parse(e),this.apms=(0,i.default)(e.apms),this.selectedApm=(0,i.default)(e.selectedApm))},loadApms:function(){this.loading=!0;var e=this;n.default.post(woocommerce_params.ajax_url,s.default.stringify({action:"woo_bg_boxnow_load_apms"})).then((function(t){e.error="";var o=[];t.data.data.apms.length?e.apms=(0,i.default)(t.data.data.apms):(e.error=t.data.data.error,e.resetData()),e.apms.forEach((function(t){e.selectedApm&&e.selectedApm.id==t.id&&(o=t)})),e.selectedApm=(0,i.default)(o),e.setCookieData(),e.loading=!1})).catch((function(t){e.message="Имаше проблем. За повече информация вижте конзолата.",console.log(t),e.loading=!1}))},setApm:function(){this.setLocalStorageData(),this.setAddress1FieldData(),this.document.trigger("update_checkout")},setCookieData:function(){var e={selectedApm:this.selectedApm?this.selectedApm.id:null};e=encodeURIComponent(JSON.stringify(e)),(0,a.setCookie)("woo-bg--boxnow-apm",e,1)},setLocalStorageData:function(){var e={selectedApm:this.selectedApm,apms:this.apms};localStorage.setItem("woo-bg--boxnow-apm",JSON.stringify(e))},resetData:function(){this.apms=(0,i.default)([]),this.selectedApm="",localStorage.removeItem("woo-bg--boxnow-apm"),this.setCookieData()},setAddress1FieldData:function(){var e="";this.selectedApm&&this.selectedApm.name&&(e=this.i18n.toApm+this.selectedApm.name+" ( "+this.selectedApm.addressLine2+" - "+this.selectedApm.addressLine1+" ) "),this.Address1Field.val(e)},triggerUpdateCheckout:function(){this.document.trigger("update_checkout")},onUpdate:function(){this.setCookieData()}},beforeDestroy:function(){this.document.off("update_checkout.setCookieApm"),this.document.off("update_checkout.onUpdate"),window.removeEventListener("message",this.setApmFromLocator,!1)}}}).call(this,o(0))},20:function(e,t){},262:function(e,t,o){"use strict";o.r(t);var a=o(277),i=o(152);for(var n in i)["default"].indexOf(n)<0&&function(e){o.d(t,e,(function(){return i[e]}))}(n);var s=o(87),r=Object(s.a)(i.default,a.a,a.b,!1,null,null,null);t.default=r.exports},277:function(e,t,o){"use strict";o.d(t,"a",(function(){return a})),o.d(t,"b",(function(){return i}));var a=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"woo-bg--boxnow-delivery"},[e.error?o("div",{staticClass:"woo-bg--apm-error"},[e._v(e._s(e.error))]):o("div",[o("multiselect",{staticClass:"woo-bg-multiselect",attrs:{id:"ajax",placeholder:"","track-by":"id",label:"name","deselect-label":"","open-direction":"bottom","options-limit":1e3,limit:6,"max-height":600,selectedLabel:e.i18n.selected,selectLabel:e.i18n.select,options:e.apms,"custom-label":e.compileLabel,multiple:!1,searchable:!0,"show-no-results":!0},on:{input:e.setApm},model:{value:e.selectedApm,callback:function(t){e.selectedApm=t},expression:"selectedApm"}},[o("span",{attrs:{slot:"noResult"},slot:"noResult"},[e._v(e._s(e.i18n.noResult))]),e._v(" "),o("span",{attrs:{slot:"noOptions"},slot:"noOptions"},[e._v(e._s(e.i18n.noOptions))]),e._v(" "),o("span",{attrs:{slot:"placeholder"},slot:"placeholder"},[e._v(e._s(e.i18n.searchApm))])]),e._v(" "),o("a",{attrs:{id:"woo-bg--boxnow-apm-locator",href:e.apmLocatorUrl}},[e._v(e._s(e.i18n.apmLocator))])],1)])},i=[]},83:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.apm=void 0,o(89);var a=n(o(88)),i=n(o(262));function n(e){return e&&e.__esModule?e:{default:e}}t.apm=a.default.extend({render:function(e){return e(i.default)}})},93:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.setCookie=function(e,t,o){var a=new Date;a.setTime(a.getTime()+24*o*60*60*1e3);var i="expires="+a.toUTCString();document.cookie=e+"="+t+";"+i+";path=/"},t.getCookie=function(e){for(var t=e+"=",o=decodeURIComponent(document.cookie).split(";"),a=0;a<o.length;a++){for(var i=o[a];" "==i.charAt(0);)i=i.substring(1);if(0==i.indexOf(t))return i.substring(t.length,i.length)}return""},t.resizeBase64=function(e,t,o,a,i,n,s){var r=document.createElement("canvas"),c=r.getContext("2d"),d=document.createElement("canvas"),l=d.getContext("2d"),m=new Image;m.src=e,m.onload=function(){var e=n(m.width,m.height,t,o),u=e.width,p=e.height;d.width=m.width,d.height=m.height,l.drawImage(m,0,0),r.width=m.width*u,r.height=m.height*p,c.imageSmoothingEnabled=!0,c.mozImageSmoothingEnabled=!0,c.oImageSmoothingEnabled=!0,c.webkitImageSmoothingEnabled=!0,c.imageSmoothingQuality="high",l.imageSmoothingEnabled=!0,l.mozImageSmoothingEnabled=!0,l.oImageSmoothingEnabled=!0,l.webkitImageSmoothingEnabled=!0,l.imageSmoothingQuality="high",c.drawImage(d,0,0,d.width,d.height,0,0,r.width,r.height),s(r.toDataURL(a,i))},m.onerror=function(){console.log("Error while loading image.")}},t.ratioFunction=function(e,t,o,a){var i=1,n=1;return e>o&&(i=o/e),t>a&&(n=a/t),n<i&&(i=n),{width:i,height:i}}}}]);